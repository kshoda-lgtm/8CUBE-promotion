ナレッジ共有基盤システム仕様書（拡張版 v2.0）
株式会社エイトキューブ プロモーション事業部

================================================================================

【新機能概要】
================================================================================

本バージョンでは、以下の3つの革新的機能を追加します：

1. 【OCR強化】過去資料一括取り込み機能
   - 既存のPowerPoint資料を一括でOCR処理
   - 画像内のテキストも自動抽出
   - 表やグラフからも情報を読み取り

2. 【AI活用】インテリジェント情報抽出
   - 文脈を理解した高精度な情報抽出
   - 曖昧な記述からも重要情報を推定
   - 類似案件の自動グルーピング

3. 【AIチャット】ナレッジ検索アシスタント
   - 自然言語での質問に対応
   - 過去の類似案件を即座に提示
   - 見積もり作成の支援

================================================================================

1. システム全体アーキテクチャ
================================================================================

1.1 3層構造モデル
------------------

【第1層：データ収集層】
┌─────────────────────────────┐
│  ・過去資料一括取り込み（OCR処理）         │
│  ・クイック取り込みフォーム                │
│  ・詳細入力フォーム                        │
└─────────────────────────────┘
                    ↓
【第2層：データ処理・蓄積層】
┌─────────────────────────────┐
│  ・AI情報抽出エンジン                      │
│  ・データクレンジング                      │
│  ・ナレッジDB（Googleスプレッドシート）    │
└─────────────────────────────┘
                    ↓
【第3層：活用層】
┌─────────────────────────────┐
│  ・AIチャットボット                        │
│  ・レポート生成                            │
│  ・見積もり支援                            │
└─────────────────────────────┘

================================================================================

2. OCR強化機能（新機能）
================================================================================

2.1 過去資料一括取り込み機能
-----------------------------

【処理フロー】
1. Googleドライブの指定フォルダから全PowerPointファイルを検索
2. 各ファイルを順次処理
   - Googleスライドに変換
   - OCRエンジンを適用（Google Cloud Vision API）
   - 画像内テキストも抽出
3. 抽出したデータを自動分類してDB登録

【OCR対象】
・スライド内のテキストボックス
・画像に埋め込まれたテキスト
・表（テーブル）内のデータ
・グラフのラベルや数値
・手書きメモ（可能な範囲で）

【処理能力】
・1回の実行で最大100ファイル
・1ファイルあたり処理時間：約30秒
・エラー発生時は自動リトライ（最大3回）

2.2 画像解析機能
----------------

【抽出可能な情報】
・商品画像から商品名を推定
・会場写真から会場の特徴を抽出
・ロゴから協力会社名を識別
・価格表の画像から数値データを抽出

================================================================================

3. AI情報抽出エンジン（新機能）
================================================================================

3.1 自然言語処理による情報抽出
-------------------------------

【従来の正規表現ベース】
単価：/単価.*?(\d+)円/

【新AIベース抽出】
・「一個あたり約500円程度」→ 単価：500円
・「ワンコイン程度で調達可能」→ 単価：500円
・「去年より2割アップ」→ 前年比情報も記録

3.2 コンテキスト理解
--------------------

【実装例】
入力：「A社の提案は良かったが、納期が厳しかった。B社は余裕があった」
抽出：
- A社：品質○、納期△
- B社：納期○

3.3 情報の信頼度スコアリング
-----------------------------

各抽出情報に信頼度スコアを付与（0-100%）
・明確な記述：90-100%
・推定値：60-89%
・曖昧な記述：30-59%

================================================================================

4. AIチャットボット機能（新機能）
================================================================================

4.1 基本仕様
------------

【インターフェース】
・Googleチャット/Slackに統合
・Web UIも提供（別途開発）

【対話例】
ユーザー：「去年の夏のキャンペーンで使った団扇の単価を教えて」
AI：「2024年7月のサマーキャンペーンで使用した団扇は以下の通りです：
- 商品名：オリジナル団扇
- 単価：85円
- 発注数：5,000枚
- 協力会社：〇〇印刷株式会社
- 評価：★★★★☆」

4.2 高度な検索機能
------------------

【類似案件検索】
ユーザー：「食品系のノベルティで成功した事例を見せて」
AI：過去3年間の食品系ノベルティから成功事例を抽出して提示

【予算ベース検索】
ユーザー：「予算50万円でできる景品企画を提案して」
AI：過去の類似予算案件から最適な組み合わせを提案

【トレンド分析】
ユーザー：「最近人気の景品傾向を教えて」
AI：直近6ヶ月のデータから人気アイテムをランキング表示

4.3 見積もり作成支援
--------------------

【自動見積もり生成】
入力：イベント概要、想定参加者数、予算
出力：過去データに基づく最適な景品構成と見積もり

【What-If分析】
「数量を2倍にしたら単価はどれくらい下がる？」
→ 過去の実績から推定値を算出

================================================================================

5. 実装計画
================================================================================

5.1 フェーズ1（1-2週間）
------------------------
・既存システムの改良
・OCR基本機能の実装
・過去資料の一括取り込み機能

5.2 フェーズ2（3-4週間）
------------------------
・AI情報抽出エンジンの実装
・信頼度スコアリング機能
・データクレンジング機能

5.3 フェーズ3（5-6週間）
------------------------
・AIチャットボットの開発
・Googleチャット連携
・Web UI開発

================================================================================

6. 必要なAPI・サービス
================================================================================

6.1 Google Cloud Platform
-------------------------
・Cloud Vision API（OCR処理）
・Natural Language API（自然言語処理）
・Vertex AI（機械学習モデル）

6.2 OpenAI API（オプション）
-----------------------------
・GPT-4（高度な自然言語理解）
・Embeddings（類似検索）

6.3 その他
----------
・Google Workspace API
・Slack API（オプション）

================================================================================

7. データベース拡張設計
================================================================================

7.1 メインテーブル（既存＋拡張）
---------------------------------

既存の20列に加えて以下を追加：

列U： OCR処理フラグ - OCRで処理されたかどうか
列V： 信頼度スコア - 情報の信頼度（0-100）
列W： 元ファイル名 - 抽出元のファイル名
列X： 処理日時 - OCR/AI処理を実行した日時
列Y： カテゴリタグ - AI自動分類タグ
列Z： 類似案件ID - 関連する案件のID群
列AA： 特記事項 - AI抽出した重要情報
列AB： 画像URL - 関連画像のリンク

7.2 補助テーブル（新規追加）
-----------------------------

【会話履歴テーブル】
・質問ID
・質問日時
・ユーザー名
・質問内容
・AI回答
・満足度評価

【OCR処理ログテーブル】
・処理ID
・ファイル名
・処理開始時刻
・処理終了時刻
・成功/失敗
・エラー詳細

================================================================================

8. セキュリティとプライバシー
================================================================================

8.1 アクセス制御
----------------
・部門単位でのアクセス権限設定
・機密情報のマスキング機能
・監査ログの記録

8.2 データ保護
--------------
・個人情報の自動検出と除外
・クライアント情報の暗号化
・定期的なバックアップ

================================================================================

9. 成功指標（KPI）
================================================================================

【効率化指標】
・見積もり作成時間：50%削減
・情報検索時間：80%削減
・重複案件の削減：30%

【活用度指標】
・月間チャットボット利用回数：500回以上
・登録データ数：月100件以上
・データ再利用率：40%以上

【品質指標】
・AI抽出精度：85%以上
・ユーザー満足度：4.0以上（5段階）
・エラー率：5%以下

================================================================================

10. 今後の拡張可能性
================================================================================

10.1 予測分析機能
-----------------
・季節トレンド予測
・価格変動予測
・需要予測

10.2 外部連携
-------------
・ECサイトとの在庫連携
・会計システムとの連携
・CRMとの顧客データ連携

10.3 モバイルアプリ
-------------------
・スマートフォンでの撮影→即座にDB登録
・外出先からのナレッジ検索
・プッシュ通知での情報共有

================================================================================

作成者：システムアーキテクト
バージョン：2.0
最終更新：2025年1月29日